(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5b42bc4b"],{"195d":function(e,t,r){"use strict";r.r(t);var o=r("d02e"),l=r("6fc3");for(var a in l)["default"].indexOf(a)<0&&function(e){r.d(t,e,(function(){return l[e]}))}(a);r("d2a3");var i=r("2877"),s=Object(i["a"])(l["default"],o["a"],o["b"],!1,null,null,null);t["default"]=s.exports},"6fc3":function(e,t,r){"use strict";r.r(t);var o=r("c744"),l=r.n(o);for(var a in o)["default"].indexOf(a)<0&&function(e){r.d(t,e,(function(){return o[e]}))}(a);t["default"]=l.a},c744:function(e,t){e.exports={data(){return{token:sessionStorage.getItem("auth_token"),dialogFormVisible1:!1,videoFlag:!1,dialogVisible:!1,hideUploadVideo:!1,ruleForm:this.cont.ruleForm4,rules:this.cont.rules4,editorOption:this.cont.editor,userId:this.$route.query.id,videoUploadPercent:0,dialogImageUrl:"",fileLists:[]}},created(){return this.load.openFullScreen(),this.userId&&this.getEdit(this.userId),!1},methods:{async getEdit(e){const{data:t}=await this.$http.getVideoEdit(e);this.ruleForm=t.data,this.fileLists=[{url:t.data.videoImage}],this.hideUploadVideo=!0},async submitForm(e){if(this.userId){const{data:e}=await this.$http.patchVideoEdit(this.userId,this.ruleForm);0==e.code&&this.$router.push("/video")}else{const{data:e}=await this.$http.postVideoEdit(this.ruleForm);0==e.code&&this.$router.push("/video")}this.$refs[e].validate(e=>e?(this.$message.success({message:"保存成功！",center:!0}),!0):(this.$message.warning({message:"内容填写不完整！",center:!0}),!1))},goBack(e){this.$refs[e].resetFields(),this.$router.push("/video")},resetForm(e){this.$refs[e].resetFields(),this.fileLists=[],setTimeout(()=>{this.hideUploadVideo=!1},100)},async T_uploadFile(e){const{data:t}=await this.$http.uploadFile(e.file);0==t.code?(this.$message.success({message:"上传成功！",center:!0}),setTimeout(()=>{this.ruleForm.teacherImage=t.data.url},500)):this.$message.error({message:"上传失败！",center:!0})},async V_uploadFile(e){this.hideUploadVideo=!0;const{data:t}=await this.$http.uploadFile(e.file);0==t.code?(this.$message.success({message:"上传成功！",center:!0}),setTimeout(()=>{this.ruleForm.videoImage=t.data.url},500)):this.$message.error({message:"上传失败！",center:!0})},beforeExcelUpload(e){if(e.size>419430.4)return this.$message.error({message:"图片大小不超过400KB!",center:"true"}),!1},handleRemove(e,t){setTimeout(()=>{this.hideUploadVideo=!1},100),this.fileLists=t,this.ruleForm.videoImage=""},handlePictureCardPreview(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},F_uploadFile(e,t){0==e.code&&(this.ruleForm.videoUrl=e.data.url)},beforeUploadVideo(e){this.ruleForm.videoUrl="";var t=e.size/1024/1024<200;const r=window.URL.createObjectURL(e),o=document.createElement("video");o.src=r;let l=this;if(-1==["video/mp4"].indexOf(e.type))return this.$message.error("请上传正确的视频格式"),this.videoFlag=!1,!1;o.oncanplay=function(){return console.log(e),this.videoWidth>1080?(l.$message.error("分辨率不得超过1080p"),l.videoFlag=!1,!1):8*e.size/1024/this.duration>6e3?(l.$message.error("视频码率不得超过6000kbps"),l.videoFlag=!1,!1):t?void(l.videoFlag=!0):(l.$message.error("视频大小不能超过200MB"),l.videoFlag=!1,!1)}},uploadchange(e,t){if("ready"===e.status){this.videoUploadPercent=0;const e=setInterval(()=>{this.videoUploadPercent>=35?clearInterval(e):this.videoUploadPercent+=1},400),t=setInterval(()=>{this.videoUploadPercent>=75?clearInterval(t):this.videoUploadPercent+=1},800),r=setInterval(()=>{this.videoUploadPercent>=99?clearInterval(r):this.videoUploadPercent+=1},1200)}"success"===e.status&&(this.videoUploadPercent=100,setTimeout(()=>{this.videoFlag=!1},1500))},uploadEorror(){this.$message.error("视频上传失败,请联系客服！"),this.hideUploadVideo=!1,this.remove()},remove(){this.$refs.uploader.abort(),this.videoFlag=!1,this.ruleForm.videoUrl=""}}}},d02e:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return l}));var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"mainIncrease"},[r("div",{staticClass:"increaseTitle"},[e._v(e._s(e.userId?"视频编辑":"视频新增"))]),r("el-form",{ref:"ruleForm",staticClass:" editForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"85px"}},[r("div",{staticStyle:{display:"flex"}},[r("div",{staticClass:"fristRow"},[r("el-form-item",{staticClass:"fristRowLabel",attrs:{label:"老师昵称:",prop:"teacherName"}},[r("el-input",{staticStyle:{width:"100%"},model:{value:e.ruleForm.teacherName,callback:function(t){e.$set(e.ruleForm,"teacherName",t)},expression:"ruleForm.teacherName"}})],1),r("el-form-item",{attrs:{label:"标　　题:",prop:"title"}},[r("el-input",{staticStyle:{width:"100%"},model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1),r("el-form-item",{staticClass:"fristRowLabel",attrs:{label:"所属年级:",prop:"grade"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.ruleForm.grade,callback:function(t){e.$set(e.ruleForm,"grade",t)},expression:"ruleForm.grade"}},e._l(e.cont.grade,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),r("el-form-item",{staticClass:"fristRowLabel",attrs:{label:"所属科目:",prop:"subject"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.ruleForm.subject,callback:function(t){e.$set(e.ruleForm,"subject",t)},expression:"ruleForm.subject"}},e._l(e.cont.subject,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),r("el-form-item",{attrs:{label:"分　　类:",prop:"type"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.ruleForm.type,callback:function(t){e.$set(e.ruleForm,"type",t)},expression:"ruleForm.type"}},[r("el-option",{attrs:{label:"card视频",value:0}}),r("el-option",{attrs:{label:"banner图",value:1}})],1)],1),r("el-form-item",{attrs:{label:"视频简介:",prop:"intro"}},[r("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",rows:6,placeholder:"请输入内容",maxlength:"140","show-word-limit":""},model:{value:e.ruleForm.intro,callback:function(t){e.$set(e.ruleForm,"intro",t)},expression:"ruleForm.intro"}})],1),r("el-form-item",{attrs:{label:"视频上传:",prop:"videoUrl"}},[r("div",{staticStyle:{display:"flex","margin-bottom":"10px"}},[r("el-upload",{ref:"uploader",staticClass:"video-uploader",attrs:{action:"/api/a/m/common/upload",headers:{userToken:e.token},"on-error":e.uploadEorror,"on-change":e.uploadchange,"on-success":e.F_uploadFile,"before-upload":e.beforeUploadVideo,"show-file-list":!1},model:{value:e.ruleForm.videoUrl,callback:function(t){e.$set(e.ruleForm,"videoUrl",t)},expression:"ruleForm.videoUrl"}},[r("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1),r("el-button",{staticStyle:{"margin-left":"25px"},attrs:{size:"small",type:"danger",icon:"el-icon-delete",circle:""},on:{click:e.remove}})],1),e.videoFlag?r("el-progress",{staticStyle:{margin:"10px auto"},attrs:{percentage:e.videoUploadPercent}}):e._e(),e.ruleForm.videoUrl?r("video",{staticClass:"avatar video-avatar",attrs:{src:e.ruleForm.videoUrl,controls:"controls",id:"video"}},[e._v(" 您的浏览器不支持视频播放 ")]):e._e()],1)],1),r("div",{staticStyle:{display:"flex","flex-direction":"column",flex:"4"}},[r("el-form-item",{staticStyle:{padding:"0 60px"},attrs:{label:"头　　像:",prop:"teacherImage"}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:"#","show-file-list":!1,"on-error":e.uploadEorror,"before-upload":e.beforeExcelUpload,"http-request":e.T_uploadFile},model:{value:e.ruleForm.teacherImage,callback:function(t){e.$set(e.ruleForm,"teacherImage",t)},expression:"ruleForm.teacherImage"}},[e.ruleForm.teacherImage?r("img",{staticClass:"avatar",attrs:{src:e.ruleForm.teacherImage}}):e._e(),r("i",{staticClass:"el-icon-upload"})])],1),r("el-form-item",{staticStyle:{margin:"66px 60px"},attrs:{label:"封　　面:",prop:"videoImage"}},[r("el-upload",{staticClass:"upload-demo",class:{hide:e.hideUploadVideo},attrs:{accept:"image/*","on-error":e.uploadEorror,"before-upload":e.beforeExcelUpload,"http-request":e.V_uploadFile,"file-list":e.fileLists,action:"#","on-remove":e.handleRemove,"on-preview":e.handlePictureCardPreview,"list-type":"picture-card",limit:1},model:{value:e.ruleForm.videoImage,callback:function(t){e.$set(e.ruleForm,"videoImage",t)},expression:"ruleForm.videoImage"}},[r("i",{staticClass:"el-icon-upload"})]),r("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("img",{attrs:{width:"100%",src:e.dialogImageUrl}})])],1)],1)]),r("el-form-item",{attrs:{label:"正　　文:",prop:"content"}},[r("quill-editor",{ref:"myTextEditor",staticClass:"editor",attrs:{options:e.editorOption},model:{value:e.ruleForm.content,callback:function(t){e.$set(e.ruleForm,"content",t)},expression:"ruleForm.content"}})],1)],1),r("div",{staticStyle:{"text-align":"center"}},[r("el-button",{attrs:{type:"success",disabled:""==e.ruleForm.grade||""==e.ruleForm.subject||null==e.ruleForm.type||""==e.ruleForm.videoUrl||""==e.ruleForm.videoImage||""==e.ruleForm.title||""==e.ruleForm.intro||""==e.ruleForm.teacherName||""==e.ruleForm.teacherImage||""==e.ruleForm.content},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("保存")]),r("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")]),r("el-button",{on:{click:function(t){return e.goBack("ruleForm")}}},[e._v("取消")])],1)],1)])},l=[]},d2a3:function(e,t,r){"use strict";var o=r("d654"),l=r.n(o);l.a},d654:function(e,t,r){}}]);
//# sourceMappingURL=chunk-5b42bc4b.7519f833.js.map